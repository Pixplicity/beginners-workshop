<!DOCTYPE HTML>
<html lang="en-US">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Lesson 5 | Android Workshop for Beginners</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="dutchaug">
        <meta name="description" content="Thanks for your interest in this Android Workshop for Beginners! This page is heads-up what the workshop is all about and to lay out the prerequisites 
to setup your Android development environment.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../cheatsheet.html" />
        
        
        <link rel="prev" href="../section4/README.html" />
        

        <meta property="og:title" content="Lesson 5 | Android Workshop for Beginners">
        <meta property="og:site_name" content="Android Workshop for Beginners">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/dutchaug">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="dutchaug/beginners-workshop" data-level="5" data-basepath=".." data-revision="1399294275009">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/dutchaug/beginners-workshop" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/dutchaug/beginners-workshop/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/dutchaug/beginners-workshop/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1><a href="../" >Android Workshop for Beginners</a></h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/dutchaug" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/dutchaug/beginners-workshop/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/dutchaug/beginners-workshop/edit/master/section5/README.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="section1/README.html">
                
                <a href="../section1/README.html">
                    <i class="fa fa-check"></i> <b>1.</b> Lesson 1
                </a>
                
                
            </li>
        
            <li  data-level="2" data-path="section2/README.html">
                
                <a href="../section2/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Lesson 2
                </a>
                
                
            </li>
        
            <li  data-level="3" data-path="section3/README.html">
                
                <a href="../section3/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Lesson 3
                </a>
                
                
            </li>
        
            <li  data-level="4" data-path="section4/README.html">
                
                <a href="../section4/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Lesson 4
                </a>
                
                
            </li>
        
            <li  data-level="5" data-path="section5/README.html">
                
                <a href="../section5/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Lesson 5
                </a>
                
                
            </li>
        
            <li  data-level="6" data-path="cheatsheet.html">
                
                <a href="../cheatsheet.html">
                    <i class="fa fa-check"></i> <b>6.</b> Cheatsheet
                </a>
                
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 83.33333333333333%;min-width: 66.66666666666667%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../section1/README.html" title="Lesson 1" class="chapter done new-chapter" data-progress="1" style="left: 16.666666666666668%;"></a>
    
        <a href="../section2/README.html" title="Lesson 2" class="chapter done new-chapter" data-progress="2" style="left: 33.333333333333336%;"></a>
    
        <a href="../section3/README.html" title="Lesson 3" class="chapter done new-chapter" data-progress="3" style="left: 50%;"></a>
    
        <a href="../section4/README.html" title="Lesson 4" class="chapter done new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="../section5/README.html" title="Lesson 5" class="chapter done new-chapter" data-progress="5" style="left: 83.33333333333333%;"></a>
    
        <a href="../cheatsheet.html" title="Cheatsheet" class="chapter  new-chapter" data-progress="6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_7">
                    
                        <h1 id="lesson-5-br-creating-a-simple-image-viewer-app">Lesson 5<br/>Creating a simple image viewer app</h1>
<h2 id="what-you-ll-learn-in-this-lesson">What you&#39;ll learn in this lesson</h2>
<ul>
<li>Basic understanding of <strong>Fragments</strong></li>
<li>Basic understanding of <strong>ViewPagers</strong> and the <strong>FragmentPagerAdapter</strong></li>
<li>Playing (animal ;-) sounds with the <strong>MediaPlayer</strong></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>In the <a href="../section4/README.html">previous lesson</a> you learned about the <a href="http://developer.android.com/guide/topics/ui/layout/listview.html" target="_blank"><strong>ListView</strong></a>. This is a vertically scrolling list of items which fluently scrolls up and down. There is no horizontal <strong>ListView</strong> in the Android SDK, but if you Google for this you will find many open source implementations of views doing exactly this. The <a href="https://github.com/lucasr/twoway-view" target="_blank">TwoWayView</a> is one of these open source implementations which can horizontally scroll a list of items. However, if you want to horizontally scroll a generic view which is larger than the screen width you can wrap a <strong>ViewGroup</strong> in a <a href="http://developer.android.com/reference/android/widget/HorizontalScrollView.html" target="_blank"><strong>HorizontalScrollView</strong></a>, which <em>is</em> a standard view.</p>
<p>In many apps you see another horizontal scroll UI pattern where you can swipe a single <em>page</em>. When you drag the view left or right the next view comes into view and when you release the view the control snaps to the <em>nearest</em> view. When you <em>fling</em> it quickly snaps to the next page, but never more than one. (If you fling a <strong>ListView</strong> or a <strong>SrollView</strong> in general it will simple scroll on and slow down and eventually stop at some position).</p>
<p>An implementation of this UI Pattern is the <a href="http://developer.android.com/reference/android/support/v4/view/ViewPager.html" target="_blank"><strong>ViewPager</strong></a> which is not part of the standard Android SDK, but was introduced in something called the <strong>Android support package</strong>. This support package is a mechanism to be able port back new functionality and components to be used on lower level Android operating systems. The <strong>ViewPager</strong> needs an implementation of <a href="http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html" target="_blank"><strong>PagerAdapter</strong></a> to populate the pages inside the <strong>ViewPager</strong>. The implementation we will use in this lesson is the <a href="http://developer.android.com/reference/android/support/v4/app/FragmentPagerAdapter.html" target="_blank"><strong>FragmentPagerAdapter</strong></a> which introduces yet another powerful UI concept, the <strong>Fragment</strong>.</p>
<h2 id="fragments">Fragments</h2>
<p><img src="img/fragment_lifecycle.png" align="right" /></p>
<p>A Fragment represents a behavior or a portion of user interface in an Activity. You can think of a fragment as a <em>modular</em> and <em>reusable</em> section of an activity, which has its own lifecycle, receives its own input events, and which you can add or remove while the activity is running (sort of like a &quot;sub activity&quot; that you can reuse in different activities).</p>
<p>A fragment must always be embedded in an activity and the fragment&#39;s lifecycle is directly affected by the host activity&#39;s lifecycle. For example, when the activity is paused, so are all fragments in it, and when the activity is destroyed, so are all fragments.</p>
<p>To create a fragment, you must create a subclass of Fragment (or an existing subclass of it). The Fragment class has code that looks a lot like an Activity. It contains callback methods similar to an activity, such as onCreate(), onStart(), onPause(), and onStop(), etc.</p>
<p>Usually, you should implement at least the following lifecycle methods:</p>
<ul>
<li><strong>onCreate()</strong> The system calls this when creating the fragment. Within your implementation, you should initialize essential components of the fragment that you want to retain when the fragment is paused or stopped, then resumed.</li>
<li><strong>onCreateView()</strong> The system calls this when it&#39;s time for the fragment to draw its user interface for the first time. To draw a UI for your fragment, you must return a View from this method that is the root of your fragment&#39;s layout. You can return null if the fragment does not provide a UI.</li>
<li><strong>onPause()</strong> The system calls this method as the first indication that the user is leaving the fragment (though it does not always mean the fragment is being destroyed). This is usually where you should commit any changes that should be persisted beyond the current user session (because the user might not come back).</li>
</ul>
<p>Most applications should implement at least these three methods for every fragment, but there are several other callback methods you should also use to handle various stages of the fragment lifecycle.</p>
<p><a href="http://developer.android.com/guide/components/fragments.html" target="_blank">More info</a></p>
<h2 id="fragment-state">Fragment state</h2>
<ol>
<li>Import the <a href="sample05">sample05</a> project in Android Studio</li>
<li>Create a new <strong>AnimalFragment</strong> class with a single <strong>ImageView</strong> which displays the image resource for the given animal.</li>
</ol>
<blockquote>
<p><strong>Tip!</strong> You can copy the class definition below, select the <code>org.dutchaug.workshop.beginners.viewpager</code> package in Android studio and past the code. The class it automagically created for you!</p>
</blockquote>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> android.os.Bundle;
<span class="hljs-keyword">import</span> android.support.v4.app.Fragment;
<span class="hljs-keyword">import</span> android.view.LayoutInflater;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.view.ViewGroup;
<span class="hljs-keyword">import</span> android.widget.ImageView;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimalFragment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Fragment</span> {</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ARG_IMAGE_RESOURCE = <span class="hljs-string">"image_resource"</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> imageResource;

    <span class="hljs-javadoc">/**
    * All subclasses of Fragment must include a public empty constructor. The framework will often 
    * re-instantiate a fragment class when needed, in particular during state restore, and needs to 
    * be able to find this constructor to instantiate it. If the empty constructor is not available, 
    * a runtime exception will occur in some cases during state restore.
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title">AnimalFragment</span>() {
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> View <span class="hljs-title">onCreateView</span>(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        ImageView imageView = (ImageView) inflater.inflate(R.layout.fragment_image, container, <span class="hljs-keyword">false</span>);
        <span class="hljs-keyword">if</span> (imageView != <span class="hljs-keyword">null</span>) imageView.setImageResource(imageResource);
        <span class="hljs-keyword">return</span> imageView;
    }

}
</code></pre>
<p>The <code>fragment_image.xml</code> file is already present and contains a sinlge <strong>ImageView</strong> element:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">ImageView</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
           <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
           <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
           <span class="hljs-attribute">android:scaleType</span>=<span class="hljs-value">"centerCrop"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ImageView</span>&gt;</span>
</code></pre>
<blockquote>
<p>The <code>android:scaleType=&quot;centerCrop&quot;</code> attribute says to center the image and <em>crop</em> it so it nicely fits the whole area.</p>
</blockquote>
<p>Okay, now we need to somehow bind the <code>imageResource</code> field to the image resource of a given <strong>Animal</strong> object. We cannot add an animal object as an extra argument directly to the <strong>onCreate</strong> method. This is a standard lifecycle method, which is used by the Android system. To add custom arguments to a fragment we must construct a new <strong>Bundle</strong> (A <strong>Bundle</strong> is a data object which holds a mapping of key-value pairs.) and add it with the <code>setArguments(Bundle args)</code> method. A commonly used method for such a construct is to create a <code>newInstance</code> method with the arguments you need for initialization, an animal object will do in our case:</p>
<pre><code class="lang-java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> AnimalFragment <span class="hljs-title">newInstance</span>(Animal animal) {

        AnimalFragment fragment = <span class="hljs-keyword">new</span> AnimalFragment();

        Bundle args = <span class="hljs-keyword">new</span> Bundle();
        args.putInt(ARG_IMAGE_RESOURCE, animal.imageResource);
        fragment.setArguments(args);

        <span class="hljs-keyword">return</span> fragment;
    }
</code></pre>
<p>Then later, in <strong>onCreate</strong> we can use the <code>getArguments()</code> method to initialize our fragment state. </p>
<pre><code class="lang-java">    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        imageResource = getArguments().getInt(ARG_IMAGE_RESOURCE);
    }
</code></pre>
<p>It might be a bit cumbersome at first, but this is the correct way to initialize your fragment. </p>
<p>We are good if our fragment is instantiated and created by the Android system. But what about this <code>savedInstanceState</code> argument? Whenever this argument is not <code>null</code> you should know that your fragment is restored by the system and your are given a <em>saved instance state bundle</em> to re-initialize your fragment. You cannot rely on the <code>getArguments</code> method to return anything useful in this case!</p>
<pre><code class="lang-java">    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        <span class="hljs-keyword">if</span> (savedInstanceState != <span class="hljs-keyword">null</span>) {
            imageResource = savedInstanceState.getInt(ARG_IMAGE_RESOURCE);
        } <span class="hljs-keyword">else</span> {
            imageResource = getArguments().getInt(ARG_IMAGE_RESOURCE);
        }
    }
</code></pre>
<p>Whenever an activity, and thus its fragment is destroyed its state will be saved. You get an opportunity to save your fragment&#39;s state by overriding the <code>public void onSaveInstanceState(Bundle outState)</code> method. You simply bind your fragment state to the given bundle argument. In our case this means:</p>
<pre><code class="lang-java">    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSaveInstanceState</span>(Bundle outState) {
        <span class="hljs-keyword">super</span>.onSaveInstanceState(outState);
        outState.putInt(ARG_IMAGE_RESOURCE, imageResource);
    }
</code></pre>
<h2 id="the-viewpager">The ViewPager</h2>
<p>The <strong>ViewPager</strong> is just another <strong>View</strong> you can include in your layout&#39;s XML file. The layout file for the <strong>MainActivity</strong> then becomes:</p>
<pre><code class="lang-xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">LinearLayout
</span>        <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
        <span class="hljs-attribute">android:orientation</span>=<span class="hljs-value">"horizontal"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:baselineAligned</span>=<span class="hljs-value">"false"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.v4.view.ViewPager
</span>            <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/view_pager"</span>
            <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">LinearLayout</span>&gt;</span>
</code></pre>
<blockquote>
<p>Notice that the <strong>ViewPager</strong> uses a <code>android.support.v4.view.</code> namespace prefix, indicating this is not a standard view, but can be found in the <code>android.support.v4.view</code> package.</p>
</blockquote>
<p>Our <strong>MainActivity</strong> can then look something like this:</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FragmentActivity</span> {</span>

    <span class="hljs-keyword">private</span> ViewPager mViewPager;

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mViewPager = (ViewPager) findViewById(R.id.view_pager);
        (...)
</code></pre>
<p>The <strong>ViewPager</strong> needs an implementation of <strong>PagerAdapter</strong> as a data-view binder. A common approach is to create an inner class which extends <strong>PagerAdapter</strong>, or the <strong>FragmentPagerAdapter</strong> in our case.</p>
<pre><code class="lang-java">    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimalPagerAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FragmentPagerAdapter</span> {</span>

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Animal&gt; mAnimals = <span class="hljs-keyword">new</span> ArrayList&lt;Animal&gt;();

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createData</span>() {
            mAnimals.add(<span class="hljs-keyword">new</span> Animal(<span class="hljs-string">"Bear"</span>, <span class="hljs-string">"Mammal"</span>, R.drawable.bear_thumb, R.drawable.bear, R.raw.bear, <span class="hljs-string">"http://a-z-animals.com/animals/bear/"</span>));
            mAnimals.add(<span class="hljs-keyword">new</span> Animal(<span class="hljs-string">"Cat"</span>, <span class="hljs-string">"Mammal"</span>, R.drawable.cat_thumb, R.drawable.cat, R.raw.cat, <span class="hljs-string">"http://a-z-animals.com/animals/cat/"</span>));
            mAnimals.add(<span class="hljs-keyword">new</span> Animal(<span class="hljs-string">"Chicken"</span>, <span class="hljs-string">"Bird"</span>, R.drawable.chicken_thumb, R.drawable.chicken, R.raw.chicken, <span class="hljs-string">"http://a-z-animals.com/animals/chicken/"</span>));
            (...)
        }

        <span class="hljs-keyword">public</span> <span class="hljs-title">AnimalPagerAdapter</span>(FragmentManager fm) {
            <span class="hljs-keyword">super</span>(fm);
            createData();
        }

    }
</code></pre>
<p>The <strong>FragmentPagerAdapter</strong> is an abstract class which asks us to implement one method: <code>public Fragment getItem(int position)</code>. </p>
<h2 id="exercise-05-01">Exercise 05.01</h2>
<p>Simply return a new <strong>AnimalFragment</strong> in the <code>public Fragment getItem(int position)</code> method.</p>
<pre><code class="lang-java">    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> Fragment <span class="hljs-title">getItem</span>(<span class="hljs-keyword">int</span> position) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// TODO Exercise 05.01 - Return a new AnimalFragment object for the given position</span>
    }
</code></pre>
<h2 id="exercise-05-02">Exercise 05.02</h2>
<p>The <strong>PagerAdapater</strong> itself is an abstract class as well, which in turn asks us to implement the <code>getCount()</code> method we saw in <a href="../section4">lesson 4</a>.</p>
<pre><code class="lang-java">    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getCount</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// TODO Exercise 05.02 - Return the amount of animals in our data set.</span>
    }
</code></pre>
<h2 id="exercise-05-03">Exercise 05.03</h2>
<p>Revisit the <code>onCreate</code> method in the <strong>MainActivity</strong> and set the adapter of the <code>mViewPager</code> object to a newly created <strong>AnimalPagerAdapter</strong>.</p>
<p><strong>Note:</strong> A <strong>FragmentPagerAdapter</strong> requires a <strong>FragmentManager</strong> instance to add its fragment to the user interface. You should use <code>getSupportFragmentManager()</code> as the argument.</p>
<p>Okay, you should have implemented enough to see the first implementation of the animal image viewer in practice. Take your project for a spin to see how it works.</p>
<h2 id="playing-an-animal-sound">Playing an animal sound</h2>
<p>You might have noticed that the <strong>Animal</strong> data object holds a new field, <code>soundResource</code>. This field is pointing to a so callled <em>raw</em> resource.</p>
<blockquote>
<p>A <strong>raw</strong> resource is basically any binary resource you want to add to your package and use in your app. </p>
</blockquote>
<p>In our case we&#39;ve included ogg vorbis sound bites for every animal in the <code>mAnimals</code> data array in the <strong>AnimalPagerAdapter</strong> class.</p>
<h2 id="exercise">Exercise</h2>
<ul>
<li>Open your <strong>AnimalFragment</strong> class and add a new integer field called <code>soundResource</code>. This looks a lot like the already defined <code>imageResource</code> field so walk through the class definition and add all the necessary code to correctly save and restore the value of this new <code>soundResource</code> field.</li>
</ul>
<p>It is good practice to let your fragment know as little as possible about its parent activity. Sometimes your fragments contains a list and when the user clicks on an item in this list it is best to let the containing activity handle the list click. In our case, when a user clicks the image we want to let our <strong>MainActivity</strong> handle this event. One way to do this is define a <strong>Contract</strong> interface in your fragment.</p>
<pre><code class="lang-java">    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Contract</span> {</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">playSound</span> (<span class="hljs-keyword">int</span> soundResource);
    }
</code></pre>
<p>Then in the <code>onCreateView</code> you can add the following code, which basically asks the fragment&#39;s activity to handle the click by passing the correct sound resource identifier.</p>
<pre><code class="lang-java">        imageView.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-annotation">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span>(View v) {
                ((Contract) getActivity()).playSound(soundResource);
            }
        });
</code></pre>
<p>In the <code>onClick</code> method we <em>cast</em> the parent activity to our <code>Contract</code> definition, so our <strong>MainActivity</strong> must implement this interface:</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FragmentActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AnimalFragment</span>.<span class="hljs-title">Contract</span></span>
</code></pre>
<p>If all&#39;s well you&#39;ll see a red curly line appear, once you add the implements statement. Simply click Alt-Enter to quick fix what&#39;s wrong, i.e. implement the missing method.</p>
<p>To make a long story short create a new <strong>MediaPlayer</strong> field with name <code>mp</code> in your <strong>MainAcitivity</strong>. With an instance of <strong>MediaPlayer</strong> you can play sounds in Android. Implement the <code>playSound</code> method with the following code.</p>
<pre><code class="lang-java">    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">playSound</span>(<span class="hljs-keyword">int</span> soundResource) {
        <span class="hljs-keyword">if</span> (mp != <span class="hljs-keyword">null</span>) { <span class="hljs-comment">// When we've previously created a MediaPlayer object</span>
            mp.release(); <span class="hljs-comment">// Stop playing the previous sound</span>
        }
        mp = MediaPlayer.create(<span class="hljs-keyword">this</span>, soundResource); <span class="hljs-comment">// Create a new MediaPlayer object for the given sound resource</span>
        mp.start(); <span class="hljs-comment">// Start playback</span>
    }
</code></pre>
<blockquote>
<p>A more convenient approach is to use Jake Wharton&#39;s ContractFragment (see <a href="https://gist.github.com/JakeWharton/2621173" target="_blank">this Gist</a>) which takes care of all the casting and extend your fragments from that class.</p>
</blockquote>
<p>That&#39;s it! Take your project for a spin!</p>
<h2 id="extra-exercises">Extra exercises</h2>
<ul>
<li>When you click on an image that animal sound will be played. When it&#39;s long and you move to the next page the other animal&#39;s sound is still playing, which is kind of confusing. Add an <strong>OnPageChangeListener</strong> to the <code>mViewPager</code> instance in <strong>MainActivity</strong> and override the <code>public void onPageSelected(int position)</code> method to stop playing the currently playing sound.</li>
<li>When you click on an image and hear a sound press the back or the home button. Do you still hear a sound? Can you explain what happens? Which activity life cycle method can you override to stop the sound from playing?</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>The <strong>ViewPager</strong> is a pretty standard view which you will use frequently in your Android apps. <strong>Fragments</strong> allow you to cut up your UI in smaller portions and with their modularity force you to chop up your app architecture as well. Fragments should know very little to nothing about their parent activities. Any user events happening inside the fragment should be propagated up to its parent activity.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../section4/README.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../cheatsheet.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
